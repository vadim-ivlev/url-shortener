## Инкремент 1

### Задание по треку «Сервис сокращения URL»

Чтобы написать сервис, который будет сжимать длинные URL до нескольких
 символов, для начала вам нужно разработать сервер.

Сервер должен быть доступен по адресу http://localhost:8080 и предоставлять два эндпоинта:

Эндпоинт с методом `POST` и путём `/`. Сервер принимает в теле запроса строку URL как `text/plain` и возвращает ответ с кодом `201` и сокращённым URL как `text/plain`.

Пример запроса к серверу:

    POST / HTTP/1.1
    Host: localhost:8080
    Content-Type: text/plain

    https://practicum.yandex.ru/ 


Пример ответа от сервера:

    HTTP/1.1 201 Created
    Content-Type: text/plain
    Content-Length: 30

    http://localhost:8080/EwHXdJfB 


Эндпоинт с методом `GET` и путём `/{id}`, где `id` — идентификатор сокращённого URL (например, `/EwHXdJfB`). В случае успешной обработки запроса сервер возвращает ответ с кодом `307` и оригинальным URL в HTTP-заголовке `Location`.

Пример запроса к серверу:

    GET /EwHXdJfB HTTP/1.1
    Host: localhost:8080
    Content-Type: text/plain 

Пример ответа от сервера:

    HTTP/1.1 307 Temporary Redirect
    Location: https://practicum.yandex.ru/ 

На любой некорректный запрос сервер должен возвращать ответ с кодом `400`.

## Инкремент 2
### Задание по треку «Сервис сокращения URL»

Покройте сервис юнит-тестами. Сконцентрируйтесь на покрытии тестами 
функций-обработчиков (хендлеров, которых пока два), чтобы защитить API сервиса от случайных изменений.

## Инкремент 3
### Задание по треку «Сервис сокращения URL»

Вы написали приложение с помощью пакета стандартной библиотеки net/http.
Используя любой внешний пакет (роутер или фреймворк), 
совместимый с net/http, перепишите ваш код.

Задача направлена на рефакторинг приложения с помощью готовой библиотеки.
Обратите внимание, что необязательно запускать приложение вручную: тесты, которые вы написали до этого, помогут вам в рефакторинге.

## Инкремент 4
### Задание по треку «Сервис сокращения URL»
Добавьте возможность конфигурировать сервис с помощью аргументов командной строки.
Создайте конфигурацию или переменные для запуска со следующими флагами:

- Флаг -a отвечает за адрес запуска HTTP-сервера (значение может быть таким: localhost:8888).
- Флаг -b отвечает за базовый адрес результирующего сокращённого URL 
 (значение: адрес сервера перед коротким URL, например http://localhost:8000/qsd54gFg).

Совет: создайте отдельный пакет config, где будет храниться структура с вашей конфигурацией и функция, которая будет инициализировать поля этой структуры. По мере усложнения конфигурации вы сможете добавлять необходимые поля в вашу структуру и инициализировать их.


## Инкремент 5
### Задание по треку «Сервис сокращения URL»

Добавьте возможность конфигурировать сервис с помощью переменных окружения:

- Адрес запуска HTTP-сервера — с помощью переменной SERVER_ADDRESS.
- Базовый адрес результирующего сокращённого URL — с помощью переменной BASE_URL.

Приоритет параметров сервера должен быть таким:
1. Если указана переменная окружения, то используется она.
1. Если нет переменной окружения, но есть аргумент командной строки (флаг), то используется он.
1. Если нет ни переменной окружения, ни флага, то используется значение по умолчанию.


## Инкремент 6
### Задание по треку «Сервис сокращения URL»

Реализуйте логирование сведений о запросах и ответах на сервере для всех эндпоинтов, которые у вас уже есть. 

- Сведения о запросах должны содержать URI, метод запроса и время, затраченное на его выполнение.
- Сведения об ответах должны содержать код статуса и размер содержимого ответа.

Эту функциональность нужно реализовать через middleware. Используйте один из сторонних пакетов для логирования:

- github.com/rs/zerolog,
- go.uber.org/zap,
- github.com/sirupsen/logrus.

Все сообщения логера должны быть на уровне Info.

## Инкремент 7
### Задание по треку «Сервис сокращения URL»

Добавьте в код сервера новый эндпоинт `POST /api/shorten`, 
который будет принимать в теле запроса JSON-объект `{"url":"<some_url>"}` 
и возвращать в ответ объект `{"result":"<short_url>"}`.
Запрос может иметь такой вид:

```
POST http://localhost:8080/api/shorten HTTP/1.1
Host: localhost:8080
Content-Type: application/json
{
  "url": "https://practicum.yandex.ru"
} 
```

Ответ может быть таким:

```
HTTP/1.1 201 OK
Content-Type: application/json
Content-Length: 30
{
 "result": "http://localhost:8080/EwHXdJfB"
} 
```

Не забудьте добавить тесты на новый эндпоинт, как и на предыдущие.
При реализации задействуйте одну из распространённых библиотек:

- encoding/json,
- github.com/mailru/easyjson,
- github.com/pquerna/ffjson.


## Инкремент 8
### Задание по треку «Сервис сокращения URL»
Добавьте поддержку gzip в ваш сервис. Научите его:

- Принимать запросы в сжатом формате (с HTTP-заголовком `Content-Encoding`).
- Отдавать сжатый ответ клиенту, который поддерживает обработку сжатых ответов (с HTTP-заголовком `Accept-Encoding`).

Функция сжатия должна работать для контента с типами `application/json` и `text/html`.

Вспомните middleware из урока про HTTP-сервер, это может вам помочь.

# Инкремент 9
## Задание по треку «Сервис сокращения URL»

Сохраните все сокращённые URL на диск в виде файла. При перезапуске сервера все URL должны быть восстановлены.

Сервер должен принимать соответствующие параметры конфигурации через флаги и переменные окружения:

 - Флаг `-f`, переменная окружения `FILE_STORAGE_PATH` — путь до файла, куда сохраняются данные в формате JSON. Имя файла для значения по умолчанию придумайте сами.

Пример содержимого файла:
```json
{"uuid":"1","short_url":"4rSPg8ap","original_url":"http://yandex.ru"}
{"uuid":"2","short_url":"edVPg3ks","original_url":"http://ya.ru"}
{"uuid":"3","short_url":"dG56Hqxm","original_url":"http://practicum.yandex.ru"} 
```

Приоритет параметров сервера должен быть таким:
- Если указана переменная окружения, то используется она.
- Если нет переменной окружения, но есть флаг, то используется он.
- Если нет ни переменной окружения, ни флага, то используется значение по умолчанию.

